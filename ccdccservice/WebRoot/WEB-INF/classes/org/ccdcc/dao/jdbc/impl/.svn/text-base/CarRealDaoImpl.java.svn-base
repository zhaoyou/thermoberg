package org.ccdcc.dao.jdbc.impl;

import java.sql.Connection;
import java.util.List;

import org.apache.commons.dbutils.QueryRunner;
import org.apache.commons.dbutils.handlers.BeanListHandler;
import org.apache.log4j.Logger;
import org.ccdcc.dao.CarRealDao;
import org.ccdcc.entity.CarRealView;
import org.ccdcc.util.ConnectionProxyFactory;

/**
 * 车载实时数据访问实现类
 * @author Administrator
 *
 */
public class CarRealDaoImpl implements CarRealDao{

	private static  Logger logger = Logger.getRootLogger();

	private ConnectionProxyFactory connectionfactory = null ;
	
	public ConnectionProxyFactory getConnectionfactory() {
		return connectionfactory;
	}

	public void setConnectionfactory(ConnectionProxyFactory connectionfactory) {
		this.connectionfactory = connectionfactory;
	}

	@SuppressWarnings("unchecked")
	public List<CarRealView> getByProject(String projectId) {	
		Connection conn=null;
		try {
			QueryRunner runner = new QueryRunner();
			conn=connectionfactory.getConnection();
			String sql = "select * from tbcccarrealview where projectId = ?  " ;
			return 	runner.query(conn, sql, new BeanListHandler<CarRealView>(CarRealView.class), new Object[]{projectId});	
		} catch (Exception e) {
			logger.error("获取车载实时信息失败: "+e.getMessage());
		} 
		finally{
			connectionfactory.closeConn(conn);
		}
		return null;
	}
}
